(()=>{"use strict";const e=()=>{const e=document.querySelectorAll(".form__file-input");0!==e.length&&e.forEach((e=>{let t,n=new DataTransfer;e.addEventListener("change",(function(){n=new DataTransfer;const r=this.files;t&&t.remove(),0!==r.length&&(t=document.createElement("ul"),t.classList.add("form__files"),e.closest(".form__field").appendChild(t),Array.from(r).forEach((r=>{n.items.add(r);const s=r.name.split("."),i=s.length>1?s.pop():"",o=s.join("."),a=document.createElement("li");a.classList.add("form__files-item");const c=document.createElement("div");c.classList.add("form__files-name");const l=document.createElement("span");l.classList.add("form__files-base"),l.textContent=o;const d=document.createElement("span");d.classList.add("form__files-format"),d.textContent=i?`.${i}`:"";const u=document.createElement("button");u.type="button",u.classList.add("form__files-remove","icon-clear"),u.addEventListener("click",(function(){a.remove();const s=Array.from(n.files).findIndex((e=>e.name===r.name&&e.size===r.size));s>-1&&(n.items.remove(s),e.files=n.files),0===t.children.length&&(t.remove(),e.value="",n=new DataTransfer)})),c.appendChild(l),c.appendChild(d),a.appendChild(c),a.appendChild(u),t.appendChild(a)})),e.files=n.files)}))}))};class t{constructor(e,t){this.input=e,this.startTime=t.startTime||"08:00",this.endTime=t.endTime||"18:30",this.timeInterval=30,this.timepicker=null,this.createTimepicker(),this.addEventListeners()}createTimepicker(){this.timepicker=document.createElement("div"),this.timepicker.classList.add("timepicker"),this.timepicker.style.display="none";const e=document.createElement("div");e.classList.add("timepicker__items");let t=this.parseTime(this.startTime);const n=this.parseTime(this.endTime);for(;t<=n;){const n=this.formatTime(t),r=document.createElement("button");r.type="button",r.classList.add("timepicker__item"),r.textContent=n,r.addEventListener("click",(()=>{this.input.value=n;const e=new Event("input",{bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)})),e.appendChild(r),t=this.addMinutes(t,this.timeInterval)}this.timepicker.appendChild(e),this.input.insertAdjacentElement("afterend",this.timepicker)}addEventListeners(){}showTimepicker(){this.timepicker.style.display="block",this.input.setAttribute("placeholder",this.input.getAttribute("placeholder").replace("↓","↑")),this.input.classList.add("focus-timepicker")}hideTimepicker(){this.timepicker.style.display="none",this.input.setAttribute("placeholder",this.input.getAttribute("placeholder").replace("↑","↓")),this.input.classList.remove("focus-timepicker")}parseTime(e){const[t,n]=e.split(":").map(Number),r=new Date;return r.setHours(t,n,0,0),r}formatTime(e){return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`}updateDisabledTimes(e){const t=new Date;t.setHours(0,0,0,0);const n=e.toDateString()===t.toDateString(),r=new Date;this.timepicker.querySelectorAll(".timepicker__item").forEach((e=>{const[t,s]=e.textContent.split(":").map(Number),i=new Date;i.setHours(t,s,0,0),e.disabled=!1,n&&i<r&&(e.disabled=!0)}))}addMinutes(e,t){return new Date(e.getTime()+6e4*t)}open(){this.showTimepicker()}close(){this.hideTimepicker()}}class n{constructor(e,t){this.element=e,this.currentDate=new Date,this.selectedDate=new Date,this.createDatepicker(),this.init()}createDatepicker(){this.datepicker=document.createElement("div"),this.datepicker.classList.add("datepicker"),this.datepicker.style.display="none";const e=document.createElement("div");e.classList.add("datepicker__body"),this.grid=document.createElement("div"),this.grid.classList.add("datepicker__grid"),e.appendChild(this.grid);const t=document.createElement("div");t.classList.add("datepicker__footer"),this.prevButton=document.createElement("button"),this.prevButton.type="button",this.prevButton.classList.add("datepicker__prev"),this.prevButton.textContent="←",this.pagination=document.createElement("span"),this.pagination.classList.add("datepicker__pagination"),this.nextButton=document.createElement("button"),this.nextButton.type="button",this.nextButton.classList.add("datepicker__next"),this.nextButton.textContent="→",t.appendChild(this.prevButton),t.appendChild(this.pagination),t.appendChild(this.nextButton),this.datepicker.appendChild(e),this.datepicker.appendChild(t),this.element.insertAdjacentElement("afterend",this.datepicker)}init(){this.element.addEventListener("clear",(()=>{this.currentDate=new Date,this.selectedDate=new Date,this.render()})),this.prevButton.addEventListener("click",(()=>this.changeMonth(-1))),this.nextButton.addEventListener("click",(()=>this.changeMonth(1))),this.render()}show(){this.datepicker.style.display="block",this.element.setAttribute("placeholder",this.element.getAttribute("placeholder").replace("↓","↑")),this.element.classList.add("focus-datepicker")}hide(){this.datepicker.style.display="none",this.element.setAttribute("placeholder",this.element.getAttribute("placeholder").replace("↑","↓")),this.element.classList.remove("focus-datepicker")}changeMonth(e){this.currentDate.setMonth(this.currentDate.getMonth()+e),this.render()}render(){this.grid.innerHTML="";const e=this.currentDate.getFullYear(),t=this.currentDate.getMonth();this.pagination.textContent=`${String(t+1).padStart(2,"0")}/12`;const n=new Date(e,t+1,0).getDate(),r=this.getFirstDayOfMonth(t,e),s=new Date(e,t,0).getDate();for(let e=r;e>0;e--){const t=s-e+1,n=this.createDayButton(t,"greyed");this.grid.appendChild(n)}for(let r=1;r<=n;r++){const n=this.createDayButton(r);r===this.selectedDate.getDate()&&t===this.selectedDate.getMonth()&&e===this.selectedDate.getFullYear()&&n.classList.add("selected"),this.grid.appendChild(n)}const i=42-(r+n);for(let e=1;e<=i;e++){const t=this.createDayButton(e,"greyed");this.grid.appendChild(t)}}getFirstDayOfMonth(e,t){const n=new Date(t,e,1).getDay();return 0===n?6:n-1}createDayButton(e,t=""){const n=document.createElement("button");n.textContent=e,n.type="button",t&&n.classList.add(t);const r=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),e),s=new Date;return s.setHours(0,0,0,0),("greyed"===t||r<s)&&(n.disabled=!0),n.addEventListener("click",(()=>{if(n.disabled)return;this.selectedDate=r,this.element.value=this.formatDate(this.selectedDate);const e=new Event("input",{bubbles:!0,cancelable:!0});this.element.dispatchEvent(e),this.render()})),n}formatDate(e){return`${String(e.getDate()).padStart(2,"0")}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`}open(){this.show()}close(){this.hide()}}class r{constructor(e={}){this.cartItems=document.querySelectorAll(".header__menu-cart"),this.openMenu=e.openMenu||function(){},this.hideMenu=e.hideMenu||function(){},this.cartContent=document.querySelector(".cart__content"),this.cartEmpty=document.querySelector(".cart__empty"),this.init()}init(){document.addEventListener("click",(e=>{const t=e.target;if(t.matches(".products__card-btn")||t.matches(".product__delete-btn")){if(t.classList.contains("pending"))return;this.updateCart(t)}}))}updateCart(e){const t=e.closest("[data-id]").getAttribute("data-id"),n=!e.classList.contains("active"),r=n?"add":"remove",s=this.getCurrentAmount();e.classList.toggle("active",n),e.classList.add("pending"),e.matches(".product__delete-btn")&&(e.textContent=n?"УДАЛИТЬ":"Выбрать");let i=s+(n?1:-1);this.updateCartUI(i),this.fetchCart(r,t).then((t=>{const{amount:n}=t;if(this.updateCartUI(n),"remove"===r&&e.closest(".cart__content")){const t=e.closest(".products__card");t&&t.parentNode.remove()}this.cartContent&&this.cartEmpty&&0===n&&(this.cartContent.classList.add("hidden"),this.cartEmpty.classList.remove("hidden"))})).catch((t=>{console.error("Ошибка при запросе к серверу:",t),e.classList.toggle("active",!n),e.matches(".product__delete-btn")&&(e.textContent=n?"Выбрать":"УДАЛИТЬ"),this.updateCartUI(s)})).finally((()=>{e.classList.remove("pending")}))}updateCartUI(e){this.cartItems.forEach((t=>{t.textContent=e,t.classList.toggle("active",e>0)})),this.openMenu(),setTimeout((()=>this.hideMenu()),2e3)}getCurrentAmount(){const e=this.cartItems[0];return e&&parseInt(e.textContent,10)||0}async fetchCart(e,t){try{const n=await fetch(`${BASE_URL}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e,id:t})});if(!n.ok)throw new Error("Ошибка запроса");return n.json()}catch(e){throw console.error("Ошибка при запросе к серверу:",e),e}}}document.addEventListener("DOMContentLoaded",(()=>{function s(){let e=document.querySelector(".header__logo");e.classList.contains("clip-logo")&&(document.querySelector(".header-fixed").classList.add("visible"),document.querySelector(".header-static").classList.add("hide"),e.classList.add("visible"))}function i(){document.querySelector(".header-fixed").classList.remove("visible"),document.querySelector(".header-static").classList.remove("hide"),document.querySelector(".header__logo").classList.remove("visible")}!function(e,t=50,n=5e3){let r=0;const s=setInterval((()=>{window.gsap&&window.ScrollTrigger?(clearInterval(s),e()):r>n&&(clearInterval(s),console.error("GSAP или ScrollTrigger не загрузились за время ожидания")),r+=t}),t)}((()=>{(()=>{function e(e){if(!e)return;const t=window.innerWidth<1440,n=!!e.closest(".header_sm"),r=t?50:80,s=e.closest(".popup")||window,i=e.querySelector(".header__logo-current"),o=r/3;gsap.set(e,{scale:1}),gsap.set(i,{autoAlpha:1});const a=t?0:.465;ScrollTrigger.create({trigger:e,scroller:s,start:0,end:n?0:3*o,scrub:!0,onUpdate:t=>{const n=t.progress,r=1-a*n;gsap.to(e,{scale:r,duration:0})},onEnter:()=>{e.classList.add("init-animation")},onLeaveBack:()=>{e.classList.remove("init-animation")}}),ScrollTrigger.create({trigger:e,scroller:s,start:n?0:3*o,end:n?o:r,scrub:!0,onUpdate:t=>{gsap.to(i,{autoAlpha:1,duration:0}),gsap.to(e,{scale:1-a,duration:0})},onLeave:()=>{e.classList.add("clip-logo")},onEnterBack:()=>{e.classList.remove("clip-logo"),setTimeout((()=>{i.style=""}),0)}}),ScrollTrigger.create({trigger:e,scroller:s,start:r,end:"+=300",scrub:!0,onUpdate:t=>{gsap.to(i,{autoAlpha:0,duration:0}),gsap.to(e,{scale:1-a,duration:0})}})}gsap.registerPlugin(ScrollTrigger),document.querySelectorAll(".header__logo").forEach((t=>{e(t)})),window.addEventListener("resize",(function(){ScrollTrigger.getAll().forEach((e=>e.kill())),document.querySelectorAll(".header__logo").forEach((t=>{t.classList.remove("clip-logo"),e(t)}))}))})()})),(()=>{const e={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return e.Android()||e.BlackBerry()||e.iOS()||e.Opera()||e.Windows()}};function t(){e.any()||window.innerWidth<992?(document.body.classList.remove("_pc"),document.body.classList.add("_touch")):(document.body.classList.remove("_touch"),document.body.classList.add("_pc"))}t(),window.addEventListener("resize",(()=>{t()}))})(),function(e){let t=new Image;t.onload=t.onerror=function(){1==(2==t.height)?document.querySelector("body").classList.add("webp"):document.querySelector("body").classList.add("no-webp")},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}(),(()=>{function e(e){e.value.length>0?e.classList.add("_input"):e.classList.remove("_input")}document.querySelectorAll(".form__field > .form__input, .form__field > .form__textarea").forEach((t=>{const n=t=>e(t.target);["input","blur","focus","change","keyup","mouseup"].forEach((e=>{t.addEventListener(e,n)})),e(t)}))})(),(()=>{var e=document.querySelectorAll('input[type="tel"]'),t=function(e){return e.value.replace(/\D/g,"")},n=function(e){var n=e.target,r=t(n),s=e.clipboardData||window.clipboardData;if(s){var i=s.getData("Text");if(/\D/g.test(i))return void(n.value=r)}},r=function(e){var n=e.target,r=t(n),s=n.selectionStart,i="";if(!r)return n.value="";if(n.value.length==s){if(["7","8","9"].indexOf(r[0])>-1){"9"==r[0]&&(r="7"+r);var o="8"==r[0]?"8":"+7";i=n.value=o+" ",r.length>1&&(i+="("+r.substring(1,4)),r.length>=5&&(i+=") "+r.substring(4,7)),r.length>=8&&(i+="-"+r.substring(7,9)),r.length>=10&&(i+="-"+r.substring(9,11))}else i="+"+r.substring(0,16);n.value=i}else e.data&&/\D/g.test(e.data)&&(n.value=r)},s=function(e){var t=e.target.value.replace(/\D/g,"");8==e.keyCode&&1==t.length&&(e.target.value="")};for(var i of e)i.addEventListener("keydown",s),i.addEventListener("input",r,!1),i.addEventListener("paste",n,!1)})(),(()=>{if(!document.querySelector(".products__filters"))return;const e=document.querySelectorAll(".products__filters-column"),t=document.querySelectorAll(".start-price, .end-price"),n=document.querySelector(".products__filters"),r=e=>{const t=String(e).replace(/\D/g,"");return 0===t.length?"":t.replace(/\B(?=(\d{3})+(?!\d))/g," ")},s=e=>{const t=e.value.replace(/\D/g,"");if(t.length>0){const n=r(t),s=e.dataset.measure?e.dataset.measure:"₽/м²";e.value=`${n} ${s}`}};function i(e){const t=e.querySelector(".products__filters-clear");e.querySelector(".products__filters-input:checked")?t.classList.remove("hidden"):t.classList.add("hidden")}e.forEach((e=>{const t=e.querySelector(".products__filters-clear"),n=e.querySelectorAll(".products__filters-input");n.length>0&&n.forEach((t=>{t.addEventListener("change",(()=>{i(e),document.dispatchEvent(new CustomEvent("filter:updated"))}))})),t&&t.addEventListener("click",(()=>{n.forEach((e=>{e.checked=!1})),i(e),document.dispatchEvent(new CustomEvent("filter:updated"))}))})),t.forEach((e=>{e.addEventListener("keydown",(e=>{e.key>="0"&&e.key<="9"||"Backspace"===e.key||"Delete"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||"Tab"===e.key||e.preventDefault()})),e.addEventListener("focus",(()=>{const t=e.value.replace(/\D/g,"");e.value=r(t)})),e.addEventListener("input",(()=>{const t=e.selectionStart,n=e.value,s=n.replace(/\D/g,""),i=r(s);e.value=i;let o=t+(e.value.length-n.length);n.length<e.value.length&&(" "===e.value.charAt(o-1)||"/"===e.value.charAt(o-1))&&(o+=1),o<0&&(o=0),e.setSelectionRange(o,o),document.dispatchEvent(new CustomEvent("filter:updated"))})),e.addEventListener("blur",(()=>{s(e),document.dispatchEvent(new CustomEvent("filter:updated"))}))})),n.addEventListener("submit",(function(e){e.preventDefault();const t=new URL(window.location.href);t.searchParams.has("pages")&&(t.searchParams.delete("pages"),history.replaceState(null,"",t.toString()));const r=n.querySelector(".start-price"),s=n.querySelector(".end-price"),i=r.value,o=s.value;r.value=r.value.replace(/\D/g,""),s.value=s.value.replace(/\D/g,""),n.submit(),r.value=i,s.value=o,document.dispatchEvent(new CustomEvent("filter:updated"))})),t.forEach((e=>{s(e)}))})(),(()=>{var e,t=("cookie_notice",(e=document.cookie.match(new RegExp("(?:^|; )"+"cookie_notice".replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(e[1]):void 0);if(void 0===t||1!=t){var n=document.createElement("div");n.classList.add("cookie","hidden"),n.innerHTML='<div class="cookie__container"><div class="row"><div class="col-md-4 offset-md-2"><button class="cookie__btn btn btn-white icon-close">НАШ САЙТ ИСПОЛЬЗУЕТ COOKIE</button></div></div></div>',document.body.appendChild(n),n.classList.remove("hidden"),document.querySelector(".cookie__btn").addEventListener("click",(function(){(function(e,t,n){var r=(n=n||{}).expires;if("number"==typeof r&&r){var s=new Date;s.setTime(s.getTime()+1e3*r),r=n.expires=s}r&&r.toUTCString&&(n.expires=r.toUTCString());var i=e+"="+(t=encodeURIComponent(t));for(var o in n){i+="; "+o;var a=n[o];!0!==a&&(i+="="+a)}document.cookie=i})("cookie_notice",1,{expires:15552e3,path:"/"}),n.classList.add("hidden")}))}})(),(()=>{let e;async function t(t){t.preventDefault();const r=t.target,s=r.getAttribute("action"),i=function(e){let t=0;return e.querySelectorAll("input, textarea, select").forEach((e=>{n(e);const r=e.hasAttribute("data-required"),s=e.value.trim();(r||""!==s||e.matches("[type='checkbox']")||e.matches("[type='radio']"))&&(r&&(""===s||e.matches("[type='checkbox']")&&!e.checked||e.matches("[name='message']")&&s.length<1)||e.matches("[type='email']")&&""!==s&&!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(s).toLowerCase())||e.matches("[type='tel']")&&""!==s&&!function(e){const t=e.replace(/\D/g,"");return t.length>=6&&/^[1-9]\d{5,14}$/.test(t)}(s))&&(function(e){e.classList.add("_error"),e.parentElement.classList.add("_error")}(e),t++)})),t}(r);if(0===i)try{if(r.classList.add("_sending"),!(await fetch(s,{method:"POST",body:new FormData(r)})).ok)throw new Error("Укажите URL, куда будет запрос в атрибуте action у формы");r.reset(),function(){const t=document.querySelector(".popup-thanks");t.classList.add("open"),document.querySelector("body").classList.add("modal-lock"),e&&clearTimeout(e),e=setTimeout((()=>{t.classList.contains("open")&&(t.classList.remove("open"),document.querySelector("body").classList.remove("modal-lock")),e=null}),5e3)}()}catch(i){console.log(i.message)}finally{r.classList.remove("_sending")}}function n(e){e.classList.remove("_error"),e.parentElement.classList.remove("_error")}function r(e){const t=e.target,n=t.querySelectorAll("._input"),r=t.querySelectorAll(".form__files"),s=t.querySelector('button[type="submit"]'),i=t.querySelector('[name="nda"]');n?.forEach((e=>e.classList.remove("_input"))),r?.forEach((e=>e.remove())),i&&(s.disabled=!0)}document.querySelectorAll("form:not(.search__form):not(.footer__form):not(.header__form):not(.products__filters)").forEach((e=>{e.addEventListener("submit",t),e.addEventListener("reset",r)})),document.addEventListener("input",(function(e){const{target:t}=e;t.classList.contains("_error")&&n(t)})),function(){const t=document.querySelectorAll("[data-modal]"),n=document.querySelector("body"),r=document.querySelectorAll(".lock-padding");function s(e){e&&(e.classList.remove("open"),r.forEach((e=>{e.style.paddingRight="0px"})),n.style.paddingRight="0px",n.classList.remove("modal-lock"))}t.forEach((e=>{e.addEventListener("click",(function(t){const i=e.getAttribute("href").replace("#",""),o=document.getElementById(i);o&&(function(e){if(e){const t=document.querySelector(".popup.open");t&&s(t),function(){const e=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";r.forEach((t=>{t.style.paddingRight=e})),n.style.paddingRight=e,n.classList.add("modal-lock")}(),e.classList.add("open")}}(o),t.preventDefault())}))})),document.querySelectorAll(".popup__close").forEach((t=>{t.addEventListener("click",(function(n){t.closest(".popup-thanks")?(e&&(clearTimeout(e),e=null),document.querySelectorAll(".popup").forEach((e=>{s(e)}))):s(t.closest(".popup")),n.preventDefault()}))})),document.addEventListener("keydown",(function(t){if("Escape"===t.key){const t=document.querySelector(".popup.open");t&&(t.classList.contains("popup-thanks")&&e&&(clearTimeout(e),e=null),s(t))}}))}()})(),e(),(()=>{const e="text-ellipsis",t=`.${e}`,n="data-full-text";function r(t){let r=t.textContent.trim();r.endsWith(":")&&(r=r.slice(0,-1)),t.setAttribute(n,r),t.classList.remove(e);const s=()=>{const e=t.getAttribute(n);if(!e)return;if(t.textContent=e+":",t.scrollWidth<=t.clientWidth)return;let r=0,s=e.length,i=0;for(;r<=s;){const n=Math.floor((r+s)/2),o=e.substring(0,n);t.textContent=o+"...:",t.scrollWidth<=t.clientWidth?(i=n,r=n+1):s=n-1}const o=i===e.length?e+":":e.substring(0,i)+"...:";t.textContent=o},i=new ResizeObserver((()=>{s()}));i.observe(t),t.parentElement&&i.observe(t.parentElement),s()}function s(){document.querySelectorAll(t).forEach((e=>{e.hasAttribute(n)||r(e)}))}const i=document.querySelector(".product__props");if(i){const e={childList:!0,subtree:!0};new MutationObserver(((e,n)=>{for(const n of e)"childList"===n.type&&n.addedNodes.forEach((e=>{1===e.nodeType&&(e.matches(t)&&r(e),e.querySelectorAll(t).forEach(r))}))})).observe(i,e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s()})(),document.getElementById("map")&&function(){let e=document.getElementById("map"),t=e.getAttribute("data-center").split(",").map(Number),n=e.getAttribute("data-placemark").split(",").map(Number);ymaps.ready((function(){var e=new ymaps.Map("map",{center:t,zoom:17},{suppressMapOpenBlock:!0});e.controls.add("zoomControl");var r=new ymaps.Placemark(n,{},{preset:"twirl#redIcon"});e.geoObjects.add(r),e.controls.remove("routeEditor")}))}(),new r({openMenu:s,hideMenu:i}),document.querySelectorAll(".daypicker")?.forEach((function(e){const r=e.querySelector("input.date"),s=e.querySelector("input.time");if(r&&s){const i=new n(r),o=new t(s,{startTime:"08:00",endTime:"18:30"});function a(){i.open(),o.open()}function c(){i.close(),o.close()}function l(){return r.value&&s.value}r.addEventListener("click",(()=>{if(!r.value){const e=new Date,t=e.getDate().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getFullYear();r.value=`${t}.${n}.${s}`,r.classList.add("_input"),o.updateDisabledTimes(e)}r.classList.contains("focus-datepicker")?c():a()})),s.addEventListener("click",(()=>{if(!r.value){const e=new Date,t=e.getDate().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getFullYear();r.value=`${t}.${n}.${s}`,r.classList.add("_input"),o.updateDisabledTimes(e)}s.classList.contains("focus-timepicker")?c():a()}));const d=r.parentNode.querySelector(".form__field-clear"),u=s.parentNode.querySelector(".form__field-clear");function p(){r.value="",s.value="",r.classList.remove("_input"),s.classList.remove("_input")}d?.addEventListener("click",(()=>{p(),c()})),u?.addEventListener("click",(()=>{p(),c()})),r.addEventListener("input",(()=>{l()&&c();const e=r.value.split(".");if(3===e.length){const[t,n,r]=e.map(Number),s=new Date(r,n-1,t);o.updateDisabledTimes(s)}})),s.addEventListener("input",(()=>{l()&&c()}))}})),document.addEventListener("click",(e=>{const t=e.target;if(t.matches(".form__field-clear")){const e=t.closest(".form__field"),n=e?.querySelector(".form__input")||e?.querySelector(".form__textarea");n.value="",n.classList.remove("_input"),n.dispatchEvent(new Event("clear"))}if(t.closest(".icon-menu")&&(document.body.classList.toggle("menu-lock"),document.querySelector(".header").classList.toggle("open-menu")),t.classList.contains("products__filters-caption")&&(t.classList.toggle("active"),t.parentNode.nextElementSibling.classList.toggle("active")),t.matches(".swiper-pagination-current")){let e=t.closest(".slider");e&&e.swiper.slidePrev()}if(t.matches(".swiper-pagination-total")){let e=t.closest(".slider");e&&e.swiper.slideNext()}if(t.matches(".header__menu-link")&&t.getAttribute("href").startsWith("#")&&i(),t.closest(".header__logo")&&t.closest(".header__logo")?.getAttribute("href")?.startsWith("#")&&i(),t.matches("[data-modal]")){if(!t.dataset.modal)return;let e=t.dataset.modal,n=document.querySelector(`.popup__menu-link[href="#${e}"]`);n&&n.click()}if(t.matches(".popup__menu-link")){e.preventDefault();let n=t.getAttribute("href").replace("#","");document.querySelectorAll(".popup__menu-link").forEach((e=>{e.classList.remove("active")})),document.querySelectorAll("[data-form]").forEach((e=>{e.classList.remove("active")})),document.querySelector(`[data-form="${n}"]`)?.classList.add("active"),t.classList.add("active")}})),document.querySelectorAll(".slider")&&document.querySelectorAll(".slider").forEach((e=>{const t=e.querySelector(".slider__next"),n=e.querySelector(".slider__prev"),r=new Swiper(e,{slidesPerView:1,watchOverflow:!0,pagination:{el:e.querySelector(".slider__pagination"),type:"fraction",renderFraction:function(e,t){return'<span class="'+e+'"></span>/<span class="'+t+'"></span>'},formatFractionCurrent:function(e){return s(e)},formatFractionTotal:function(e){return s(e)}},on:{init:e=>{1===e.slides.length&&e.el.classList.add("swiper-single-slide")}}});function s(e){return e<10?"0"+e:e}t.addEventListener("click",(()=>{r.isEnd?r.slideTo(0):r.slideNext()})),n.addEventListener("click",(()=>{r.isBeginning?r.slideTo(r.slides.length-1):r.slidePrev()})),r.slides.forEach((e=>{e.addEventListener("click",(t=>{const n=e.getBoundingClientRect();t.clientX-n.left<.5*n.width?r.isBeginning?r.slideTo(r.slides.length-1):r.slidePrev():r.isEnd?r.slideTo(0):r.slideNext()}))}))})),document.querySelector(".header__logo")&&(document.querySelector(".header__logo").addEventListener("mouseenter",(e=>{scrollY>document.querySelector(".header").offsetHeight&&s()})),document.querySelector(".header__top").addEventListener("mouseenter",(e=>{scrollY>document.querySelector(".header").offsetHeight&&s()})),document.querySelector(".header-fixed").addEventListener("mouseleave",(e=>{i()})),window.addEventListener("wheel",(function(e){e.deltaY>0?i():s()}))),document.querySelectorAll('[name="nda"]').length>0&&document.querySelectorAll('[name="nda"]').forEach((e=>{e.addEventListener("change",(e=>{e.target.checked?e.target?.closest("form")?.querySelector('button[type="submit"]').removeAttribute("disabled"):e.target?.closest("form")?.querySelector('button[type="submit"]').setAttribute("disabled","disabled")}))}));const o=document.querySelectorAll('input[name="product-color"]'),a=Array.from(document.querySelectorAll(".product__options-seem"));if(o&&a.length){const e=document.querySelector(".product__options-title");o.forEach((t=>{t.addEventListener("change",(function(){this.checked&&window.requestAnimationFrame((()=>{const t=this.value;a.forEach((e=>{e.classList.remove("active")}));const n=document.querySelector(`.product__options-seem[src*="${t}.png"]`);n?(n.classList.add("active"),e.textContent=n.getAttribute("title")):console.warn(`Image for value ${t} not found`)}))}))}))}function c(e){e?.forEach((e=>{e.complete?e.classList.add("loaded"):e.addEventListener("load",(()=>{e.classList.add("loaded")}))}))}c(document.querySelectorAll(".fade-load-image")),new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&e.addedNodes.forEach((e=>{1===e.nodeType&&e.classList.contains("fade-load-image")&&c([e]);const t=e.querySelectorAll?.(".fade-load-image");t&&t.length&&c(t)}))}))})).observe(document.body,{childList:!0,subtree:!0});const l=document.querySelector(".products__share");if(l){let e;l.addEventListener("click",(async function(t){t.preventDefault(),clearTimeout(e),l.classList.add("submit"),l.classList.remove("success"),l.textContent="Получение ссылки";try{const t=await fetch(`${CART_SHARE_URL}`,{method:"GET"});if(!t.ok)throw new Error("Ошибка получения ссылки");const n=await t.text();if(window.innerWidth<=768&&navigator.share)await navigator.share({title:document.title,url:n});else if(navigator.clipboard)await navigator.clipboard.writeText(n);else{const e=document.createElement("textarea");e.value=n,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}l.classList.remove("submit"),l.classList.add("success"),l.textContent="Ссылка скопирована",e=setTimeout((()=>{l.classList.remove("success"),l.textContent="Поделиться корзиной ↽"}),5e3)}catch(e){console.error("Ошибка:",e),l.classList.remove("submit"),l.textContent="Поделиться корзиной ↽"}}))}document.querySelectorAll("[data-vk-video]")?.forEach((e=>{const t=e.dataset.videoCode,n=e.dataset.videoOwner;if(!t||!n)return;const r=document.createElement("div");r.className="vk-video-wrapper";const s=document.createElement("iframe");s.setAttribute("allowfullscreen",""),s.setAttribute("allow","autoplay"),s.setAttribute("frameborder","0"),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.src=`https://vk.com/video_ext.php?oid=${n}&id=${t}&hd=2&autoplay=0`,r.appendChild(s),e.appendChild(r),e.appendChild(playBtn)}));let d=parseInt(new URLSearchParams(window.location.search).get("pages"))||1,u=null;function p(){u&&u.disconnect();const e=document.querySelector("#more__button > a");e&&(u=new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&(t.unobserve(e.target),m(e.target))}))}),{rootMargin:"0px 0px 200px 0px"}),u.observe(e))}function m(e){const t=e.dataset.type,n=e.getAttribute("href"),r=document.querySelector(`#js-${t}-loader`),s=e.closest("#more__button");s&&s.remove(),d++;const i=new URL(window.location.href),o=parseInt(i.searchParams.get("pages"))||1;d!==o&&(i.searchParams.set("pages",d),history.pushState({page:d},"",i)),fetch(n+(n.includes("?")?"&":"?")+"ajax=Y").then((e=>e.text())).then((e=>{r&&r.insertAdjacentHTML("beforeend",e),p()})).catch((e=>{console.error("Ошибка при загрузке:",e)}))}document.addEventListener("click",(function(e){const t=e.target.closest("#more__button > a");t&&(e.preventDefault(),m(t))})),window.addEventListener("popstate",(function(e){if(location.hash)return;const t=e.state?.page;location.href=t?location.pathname+"?pages="+t:location.pathname})),p(),document.addEventListener("filter:updated",(()=>{p()}));const h=document.querySelectorAll('[id^="js-"][id$="-loader"]');h?.forEach((e=>{e&&new MutationObserver((()=>{p()})).observe(e,{childList:!0,subtree:!0})}))}))})();